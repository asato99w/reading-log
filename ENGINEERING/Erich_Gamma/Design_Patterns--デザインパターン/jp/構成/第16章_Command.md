# 第16章：Command（動作パターン）

## 章の概要
リクエストをオブジェクトとしてカプセル化し、異なるリクエストでクライアントをパラメータ化し、操作のキューイング、元に戻す機能をサポートできるようにします。

## 主な内容

### 意図と構造
- リクエストをオブジェクトとしてカプセル化し異なるリクエストでクライアントのパラメータ化を可能
- 後で実行や永続化のためリクエストをキュー、スケジュール、ログ記録
- コマンド状態を保存し逆操作を実装することで元に戻す操作をサポート
- 操作を呼び出すオブジェクトと操作を実行するオブジェクトを分離

### パターン参加者
- **Command**：操作実行のための実行メソッドを宣言するインターフェース
- **ConcreteCommand**：CommandインターフェースでReceiverと動作間の結合を実装・定義
- **Receiver**：コマンド実行時に実際の作業を実行するオブジェクト
- **Invoker**：特定コマンドやレシーバーを知ることなくコマンドにリクエスト実行を依頼
- **Client**：ConcreteCommandオブジェクトを作成しそのレシーバーを設定

### 実装上の考慮事項
- コマンドは実行と元に戻す操作に必要な状態を保存可能
- マクロコマンドは複雑操作のため複数コマンドを結合可能
- コマンド履歴がコマンドスタック管理を通じて元に戻す/やり直し機能を可能
- コマンドは永続化、ログ記録、ネットワーク送信のためシリアル化可能

### 高度なアプリケーション
- **キューイング**：コマンドをバッチ処理やスケジュール実行のためキューに配置可能
- **ログ記録**：監査証跡やクラッシュ回復のためコマンド実行をログ記録可能
- **トランザクション**：コミット/ロールバックセマンティクスでコマンドをトランザクションにグループ化可能
- **リモート実行**：ネットワーク境界を越えてコマンド送信可能

## 重要ポイント
- **リクエストカプセル化**：Commandはメソッド名、レシーバー、パラメータを含む操作実行に必要なすべての情報をカプセル化
- **分離**：InvokerはReceiverから分離され、コマンドインターフェースについてのみ知り、柔軟なリクエスト処理を可能
- **元に戻すサポート**：コマンドは元に戻す操作に必要な状態を保存でき、アプリケーションでの洗練された元に戻す/やり直し機能を可能