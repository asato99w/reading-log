# 第14章：Proxy（構造パターン）

## 章の概要
他のオブジェクトへのアクセスを制御するため、元のオブジェクトを変更することなく追加機能を可能にする代理またはプレースホルダーを提供します。

## 主な内容

### 意図と構造
- 仲介として機能する代理を提供して他のオブジェクトへのアクセスを制御
- 元のオブジェクトを修正せずに追加動作（遅延読み込み、アクセス制御、キャッシュ）を追加
- 異なるアドレス空間にある可能性のあるオブジェクトに対して位置透明性を提供
- 参照カウントや他のオブジェクトライフサイクル管理を実装

### パターン参加者
- **Subject**：RealSubjectとProxyの共通インターフェース、ProxyがRealSubjectが期待される場所で使用可能
- **RealSubject**：Proxyが表現する実際のオブジェクト、実際の機能を定義
- **Proxy**：RealSubjectへの参照を維持してアクセスを制御、RealSubjectと同じインターフェースを実装

### プロキシのタイプ
- **Remote Proxy**：異なるアドレス空間のオブジェクトに対するローカル代表を提供
- **Virtual Proxy**：要求に応じて高価なオブジェクトを作成、遅延読み込みを実装
- **Protection Proxy**：アクセス権に基づいて元のオブジェクトへのアクセスを制御
- **Smart Reference**：オブジェクトアクセス時に追加アクション（参照カウント、ロック）を提供

### 実装上の考慮事項
- ProxyインターフェースはSubjectインターフェースと正確に一致して透明置換を可能にすべき
- Proxyは存在しない場合にRealSubjectインスタンスを作成する必要がある場合（遅延読み込み）
- Copy-on-writeプロキシは修正が必要になるまでコピーを延期
- 参照管理プロキシはオブジェクト使用を追跡しクリーンアップを行う

## 重要ポイント
- **制御されたアクセス**：Proxyは実オブジェクトへの制御されたアクセスを提供し、セキュリティや遅延読み込みなどの追加機能を可能
- **透明置換**：Proxyは実オブジェクトと同じインターフェースを実装し、クライアントコードでの透明な置換を可能
- **位置独立性**：Proxyは実オブジェクトの位置詳細を隠すことができ、ローカル、リモート、まだ作成されていないオブジェクトかどうかに関係なく