# 第1章：リファクタリング、最初の例

## 章概要
この開始章はビデオレンタル店プログラムを改善する完全で現実的な例を通じてリファクタリングを実演する。理論を説明する前に実演することで、ファウラーはリファクタリングのリズムと規律を確立する。

## 主要内容
- **開始プログラム**
  - ビデオレンタル顧客のための明細生成
  - 計算、分類、フォーマットを混在させたモノリシックメソッド
  - レンタルコストと常連客ポイントを決定するswitch文
  - HTML出力などの新要件に対する修正困難

- **リファクタリングプロセス**
  - 明細メソッドをより小さな部分に分解
  - 金額計算と常連客ポイント計算の抽出
  - メソッドを適切なクラスへ移動（CustomerからRentalへ、そしてMovieへ）
  - タイプコードをStateパターンを使用したポリモーフィズムで置換
  - 異なる出力形式のための別メソッド作成

- **適用された主要リファクタリング**
  - メソッドの抽出：大きなメソッドの分解
  - メソッドの移動：適切なクラスへの振る舞い再配置
  - 一時変数を問い合わせメソッドで置換：一時変数の除去
  - タイプコードを状態/戦略で置換：タイプ固有振る舞いのためのポリモーフィズム使用
  - テンプレートメソッドの形成：類似アルゴリズムのための抽象構造作成

## 重要なポイント
- 小さく、テストされたステップが大規模変換を安全で管理可能にする
- リファクタリングは最初にコード構造を改善することで新機能追加を容易にする
- リファクタリングのリズム：テスト、小さな変更、テスト、コミット